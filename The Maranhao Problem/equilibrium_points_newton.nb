(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24616,        683]
NotebookOptionsPosition[     23138,        625]
NotebookOutlinePosition[     23485,        640]
CellTagsIndexPosition[     23442,        637]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Equilibrium points of the Maranhao problem with the Newton--Raphson method
F. I. Giasemis\
\>", "Section",
 CellChangeTimes->{{3.816590660102048*^9, 3.8165907036207514`*^9}, 
   3.8165913416939087`*^9, 3.816591440835854*^9, {3.816593549979395*^9, 
   3.816593572105217*^9}, {3.816775958109437*^9, 3.816775959116829*^9}}],

Cell[CellGroupData[{

Cell["Newton--Raphson method for 1D case", "Subsection",
 CellChangeTimes->{{3.816590904538834*^9, 3.816590934059972*^9}, 
   3.816775959808981*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "-", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "x_", "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "10"}], ",", 
    RowBox[{"i", "=", 
     RowBox[{"i", "+", "1"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"i", "+", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "-", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"x", "[", "i", "]"}], "]"}], "/", 
        RowBox[{"f1", "[", 
         RowBox[{"x", "[", "i", "]"}], "]"}]}]}]}], ";", 
     RowBox[{"last", "=", 
      RowBox[{"i", "+", "1"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"i", "+", "1"}], "]"}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], "]"}], "<", "1*^-10"}], ",", 
       RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"x", "[", "last", "]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8165219540944834`*^9, 3.816521954101465*^9}, {
   3.816522024766012*^9, 3.816522136312459*^9}, 3.816522182060976*^9, {
   3.8165222224522867`*^9, 3.8165223116124544`*^9}, {3.816522346823877*^9, 
   3.8165224590296555`*^9}, {3.8165225014556065`*^9, 3.816522504159377*^9}, {
   3.816522574979761*^9, 3.816522577297599*^9}, {3.816522639756727*^9, 
   3.816522640697212*^9}, {3.816522695921734*^9, 3.816522715034087*^9}, {
   3.816522793986372*^9, 3.8165228132427893`*^9}, {3.8165230461618443`*^9, 
   3.816523050468301*^9}, {3.8165231130329323`*^9, 3.8165231325476694`*^9}, {
   3.816523169770941*^9, 3.816523274605405*^9}, {3.8165233686163044`*^9, 
   3.8165233792416787`*^9}, {3.8165234394140615`*^9, 3.81652346765499*^9}, {
   3.816523509974236*^9, 3.81652351240673*^9}, 3.816523553357189*^9, {
   3.8165236558383536`*^9, 3.8165236652158165`*^9}, {3.816523904531253*^9, 
   3.816523922079179*^9}, {3.81652397715289*^9, 3.8165240109289446`*^9}, 
   3.8165241262044153`*^9, {3.816524279838583*^9, 3.81652428717098*^9}, {
   3.81652434442175*^9, 3.81652434622689*^9}, {3.8165244317646723`*^9, 
   3.8165244637456713`*^9}, {3.816524521259536*^9, 3.8165245238336515`*^9}, {
   3.816524578079541*^9, 3.816524578833491*^9}, {3.816524904744107*^9, 
   3.816524909842435*^9}, {3.8165249703925776`*^9, 3.816524979539629*^9}, {
   3.8165250200794697`*^9, 3.816525052065484*^9}, 3.816525140333276*^9, 
   3.816585165897673*^9, {3.8165904488848248`*^9, 3.8165904516815567`*^9}, 
   3.8165906062540865`*^9, {3.8165907138640733`*^9, 3.8165907305880504`*^9}, 
   3.81659088674207*^9}],

Cell[BoxData["1.4142135623730951`"], "Output",
 CellChangeTimes->{3.8165251408808107`*^9, 3.816585166902012*^9, 
  3.8165936179816737`*^9, 3.8166069806650596`*^9, 3.8166077664369087`*^9, 
  3.81660782250587*^9, 3.8167780259261045`*^9, 3.8177498557336283`*^9, 
  3.8178175738247128`*^9, 3.8195435223169193`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Newton--Raphson method for 2D case", "Subsection",
 CellChangeTimes->{{3.8165909262883973`*^9, 3.8165909377310123`*^9}, 
   3.816775960603464*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g1", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "+", 
    RowBox[{"y", "^", "2"}], "-", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g2", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"x", "+", 
    RowBox[{"1.1", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g1", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"g2", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"j", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "15"}], ",", 
     RowBox[{"i", "=", 
      RowBox[{"i", "+", "1"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"i", "+", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{"r", "[", "i", "]"}], "-", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}],
          ".", 
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}]}]}]}], 
      ";", 
      RowBox[{"last", "=", 
       RowBox[{"i", "+", "1"}]}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "inverse", " ", "calculation", " ", "above", " ", "may", " ", 
    "prove", " ", "too", " ", "computationally", " ", "expensive", " ", "for",
     " ", "more", " ", "complicated", " ", 
    RowBox[{"cases", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"r", "[", "last", "]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8165855043302364`*^9, 3.816585531130653*^9}, {
   3.816585569689365*^9, 3.8165857951549163`*^9}, {3.8165858472072525`*^9, 
   3.8165859004502707`*^9}, {3.8165859868397465`*^9, 
   3.8165860206635633`*^9}, {3.8165860656766534`*^9, 3.8165862426005783`*^9}, 
   3.8165862783771067`*^9, {3.8165863862739267`*^9, 3.8165864088909826`*^9}, {
   3.8165864500225105`*^9, 3.8165864513720512`*^9}, {3.8165865182896175`*^9, 
   3.8165865395882654`*^9}, {3.816586574932182*^9, 3.8165865780644255`*^9}, {
   3.816586666072873*^9, 3.816586679053605*^9}, {3.8165867106855593`*^9, 
   3.8165867511179705`*^9}, {3.8165868031446853`*^9, 3.816586831002787*^9}, {
   3.8165873843639216`*^9, 3.816587386698035*^9}, {3.8165876737488832`*^9, 
   3.816587708476697*^9}, {3.816587884559858*^9, 3.8165878898217473`*^9}, {
   3.816587947608694*^9, 3.8165879586042423`*^9}, 3.816588006151043*^9, 
   3.81658805227343*^9, {3.8165881138826466`*^9, 3.816588114016326*^9}, {
   3.816588312133958*^9, 3.816588332875286*^9}, {3.8165883937923183`*^9, 
   3.8165884283389497`*^9}, 3.8165884617265596`*^9, {3.816588517680371*^9, 
   3.816588518576974*^9}, {3.8165886059087777`*^9, 3.816588614658623*^9}, {
   3.8165900086782207`*^9, 3.8165900247107763`*^9}, {3.8165902243493176`*^9, 
   3.8165903046751614`*^9}, {3.816590361322344*^9, 3.8165903894936857`*^9}, {
   3.816590420048893*^9, 3.8165904230044146`*^9}, {3.8165910444908943`*^9, 
   3.8165911281273127`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.3398959639633437`"}], ",", "2.127178149057585`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.816588025638242*^9, 3.8165880544416304`*^9}, 
   3.816588115409563*^9, 3.8165881569801865`*^9, {3.816588444521636*^9, 
   3.816588472573024*^9}, 3.816588520721431*^9, {3.816588608444957*^9, 
   3.816588615855464*^9}, {3.8165899966028347`*^9, 3.8165900257098513`*^9}, 
   3.816590192426715*^9, 3.816590225035983*^9, 3.816590267118902*^9, 
   3.8165903052325506`*^9, {3.816590361997099*^9, 3.816590423316019*^9}, 
   3.816593618169156*^9, 3.8166069807384663`*^9, 3.8166077664800673`*^9, 
   3.816607822722291*^9, 3.8167780260467806`*^9, 3.8177498654363775`*^9, 
   3.8178175744466224`*^9, 3.819543522460534*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison with built-in solution NSolve[]", "Subsubsection",
 CellChangeTimes->{{3.8165909925996375`*^9, 3.816591007783966*^9}, {
   3.816591176274144*^9, 3.81659118298565*^9}, 3.816775962722285*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "-", "10"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"x", "+", 
       RowBox[{"1.1", "*", "y"}]}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8165889401482034`*^9, 3.816588940820368*^9}, {
  3.8165891230288625`*^9, 3.816589196313763*^9}, {3.816589321375575*^9, 
  3.816589322602897*^9}, {3.81659029477569*^9, 3.8165902957731476`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"-", "2.339895963963344`"}]}], ",", 
     RowBox[{"y", "\[Rule]", "2.127178149057585`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "2.339895963963344`"}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"-", "2.127178149057585`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8165889413454027`*^9, {3.8165891626445475`*^9, 3.8165891966261635`*^9}, 
   3.8165893242739334`*^9, 3.8165903104963245`*^9, 3.8165936182316217`*^9, 
   3.816606980781826*^9, 3.816607766501668*^9, 3.816607822756239*^9, 
   3.816778026088709*^9, 3.8178175746490417`*^9, 3.8195435225174227`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Maranhao problem", "Subsection",
 CellChangeTimes->{{3.816591425304248*^9, 3.8165914287086134`*^9}, {
   3.8165914985052443`*^9, 3.8165915243193364`*^9}, 3.816775964019479*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ux", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"U", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Uy", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"U", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.816334080928753*^9, 3.8163341433375297`*^9}, {
  3.8163341742275724`*^9, 3.816334195920176*^9}, {3.8163342273160763`*^9, 
  3.816334323091606*^9}, {3.816334400979493*^9, 3.81633440596611*^9}, {
  3.8163344429345646`*^9, 3.816334661020293*^9}, {3.816334792718565*^9, 
  3.816334796158011*^9}, {3.8165936238429527`*^9, 3.8165937531611204`*^9}, {
  3.8167172413208203`*^9, 3.8167172420888557`*^9}, {3.8167172737880116`*^9, 
  3.8167172746518774`*^9}, {3.816717619713686*^9, 3.816717620330947*^9}, {
  3.8167779120028744`*^9, 3.8167779186860085`*^9}}],

Cell[CellGroupData[{

Cell["The method for a point", "Subsubsection",
 CellChangeTimes->{{3.8166101957519965`*^9, 3.816610200353655*^9}, 
   3.816775965316316*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dU", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ux", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"Uy", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jac", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dU", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     RowBox[{"-", "10"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "20"}], ",", 
     RowBox[{"i", "=", 
      RowBox[{"i", "+", "1"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"i", "+", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{"r", "[", "i", "]"}], "-", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"jac", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}],
          ".", 
         RowBox[{"dU", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}]}]}]}], 
      ";", 
      RowBox[{"lasti", "=", 
       RowBox[{"i", "+", "1"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"i", "+", "1"}], "]"}], "-", 
           RowBox[{"r", "[", "i", "]"}]}], "]"}], "<", "1*^-10"}], ",", 
        RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "inverse", " ", "calculation", " ", "above", " ", "may", " ", 
    "prove", " ", "too", " ", "computationally", " ", "expensive", " ", "for",
     " ", "more", " ", "complicated", " ", 
    RowBox[{"cases", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Round", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"r", "[", "lasti", "]"}], "]"}], ",", "0.0000001"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.816608658360821*^9, 3.816608665711198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.2836915`"}], ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.816608668630354*^9, 3.8166094139273605`*^9, 
  3.8167779306919174`*^9, 3.8167780261744394`*^9, 3.81781757501132*^9, 
  3.819543522618174*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The method for a grid of points", "Subsubsection",
 CellChangeTimes->{{3.8166101719346633`*^9, 3.8166102069194307`*^9}, 
   3.8167759665748625`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listpointsnewton", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dU", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ux", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"Uy", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jac", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dU", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", 
    RowBox[{"-", "2"}]}], ",", 
   RowBox[{"j", "<", "2"}], ",", 
   RowBox[{"j", "+=", ".3"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"-", "2"}]}], ",", 
     RowBox[{"k", "<", "2"}], ",", 
     RowBox[{"k", "+=", ".3"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", "1", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "40"}], ",", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"i", "+", "1"}], "]"}], "=", 
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], "-", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{"jac", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{
                 RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{
                 RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], 
             "]"}], ".", 
            RowBox[{"dU", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"r", "[", "i", "]"}], ",", "1"}], "]"}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"r", "[", "i", "]"}], ",", "2"}], "]"}]}], 
             "]"}]}]}]}], ";", 
         RowBox[{"lasti", "=", 
          RowBox[{"i", "+", "1"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "-", 
              RowBox[{"r", "[", "i", "]"}]}], "]"}], "<", "1*^-15"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "inverse", " ", "calculation", " ", "above", " ", "may", 
        " ", "prove", " ", "too", " ", "computationally", " ", "expensive", 
        " ", "for", " ", "more", " ", "complicated", " ", 
        RowBox[{"cases", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"listpointsnewton", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"r", "[", "lasti", "]"}], "]"}], ",", "0.0000000001"}], 
         "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listpointsnewton", "=", 
   RowBox[{"DeleteDuplicates", "[", "listpointsnewton", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8165939083245134`*^9, 3.8165939788551097`*^9}, {
   3.816594022338722*^9, 3.8165940229967127`*^9}, {3.816594075732358*^9, 
   3.8165940926098013`*^9}, {3.816594166850254*^9, 3.816594205086234*^9}, {
   3.816594255739663*^9, 3.816594258176755*^9}, {3.8165943035328026`*^9, 
   3.8165943430750294`*^9}, {3.816594386520045*^9, 3.8165943951919274`*^9}, {
   3.8165944547354803`*^9, 3.816594499697869*^9}, {3.8165945430366*^9, 
   3.816594602912192*^9}, {3.816594633989705*^9, 3.8165946486845007`*^9}, {
   3.81659502909897*^9, 3.8165950355189505`*^9}, 3.8166072708200073`*^9, {
   3.81660784746018*^9, 3.816607876663055*^9}, {3.816607993285593*^9, 
   3.8166079961748877`*^9}, {3.8166081438140507`*^9, 
   3.8166082054892693`*^9}, {3.8166083658026667`*^9, 3.8166084599417524`*^9}, 
   3.8166084947401323`*^9, {3.8166085329182444`*^9, 3.8166085547647977`*^9}, {
   3.81660858550062*^9, 3.816608631439685*^9}, {3.816608697393422*^9, 
   3.8166087091809506`*^9}, {3.816608752095165*^9, 3.8166087752033095`*^9}, {
   3.816608811267887*^9, 3.816608820176055*^9}, {3.816608868229226*^9, 
   3.81660889075311*^9}, {3.816608973472732*^9, 3.8166090012058134`*^9}, {
   3.8166090690279503`*^9, 3.816609286119436*^9}, {3.8166100378453074`*^9, 
   3.8166101221450343`*^9}, {3.816610227811552*^9, 3.8166102474839363`*^9}, {
   3.8167159864851866`*^9, 3.8167160070217924`*^9}, {3.8177489796444817`*^9, 
   3.817749092078846*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The solution", "Subsubsection",
 CellChangeTimes->{{3.8166102758021946`*^9, 3.8166102825740824`*^9}, 
   3.816775968149995*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listpointsnewton", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.816610231156606*^9, 3.816610235014329*^9}, {
  3.816716015150072*^9, 3.8167160160470095`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"-", "0.2836915257`"}], "0.`"},
    {"0.`", "0.5367528128`"},
    {"0.`", 
     RowBox[{"-", "0.5367528128`"}]},
    {
     RowBox[{"-", "0.8043144342`"}], "0.`"},
    {"0.2836915257`", "0.`"},
    {"0.8043144342`", "0.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8166102358949327`*^9, 3.816610249808719*^9}, 
   3.8167160171094685`*^9, 3.8167779432848654`*^9, 3.8167780263978415`*^9, {
   3.817748701950221*^9, 3.817748708124087*^9}, 3.817748960388833*^9, {
   3.817748994970533*^9, 3.8177490186486287`*^9}, 3.8177491131704884`*^9, {
   3.817749870376862*^9, 3.817749883991648*^9}, {3.8177505527951555`*^9, 
   3.8177505717924657`*^9}, 3.817750610275939*^9, 3.8177506882490697`*^9, 
   3.8177507242985907`*^9, 3.8178175758424306`*^9, 3.819543522856495*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 646},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 330, 6, 111, "Section"],
Cell[CellGroupData[{
Cell[935, 32, 148, 2, 49, "Subsection"],
Cell[CellGroupData[{
Cell[1108, 38, 3095, 70, 126, "Input"],
Cell[4206, 110, 310, 4, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4565, 120, 152, 2, 49, "Subsection"],
Cell[CellGroupData[{
Cell[4742, 126, 4221, 106, 183, "Input"],
Cell[8966, 234, 762, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9765, 252, 206, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[9996, 258, 612, 16, 30, "Input"],
Cell[10611, 276, 728, 17, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11400, 300, 186, 2, 49, "Subsection"],
Cell[11589, 304, 1156, 28, 69, "Input"],
Cell[CellGroupData[{
Cell[12770, 336, 141, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[12936, 342, 2846, 88, 164, "Input"],
Cell[15785, 432, 266, 6, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16100, 444, 154, 2, 39, "Subsubsection"],
Cell[16257, 448, 5180, 125, 349, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21474, 578, 133, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[21632, 584, 190, 3, 30, "Input"],
Cell[21825, 589, 1261, 30, 114, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

